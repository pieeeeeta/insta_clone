<% provide(:title, "Mypage") %>

<div class="mypage_wrapper pt-5 mt-5 bg-light">

  <div class="row">
    <div class="col-3 plofile_img_wrapper">
      <div class="profile_img bg-secondary"></div>
    </div>
    <div class="col-9">
      <div class="username mb-2">
        <%= @user.username %>
        <% if current_user?(@user) %>
          <%= link_to "プロフィールを編集", profile_edit_path, class:"btn btn-outline-secondary btn-sm ml-3" %>
        <% else %>
          <% if current_user.following?(@user)%>
            <%= form_for(current_user.active_relationships.find_by(followed_id: @user.id),
             html: { method: :delete }) do |f| %>
            <%= f.submit "Unfollow", class: "btn btn-outline-secondary btn-sm" %>
            <% end %>
          <% else %>
            <%= form_for(current_user.active_relationships.build) do |f| %>
            <div><%= hidden_field_tag :followed_id, @user.id %></div>
            <%= f.submit "Follow", class: "btn btn-outline-secondary btn-sm" %>
            <% end %>
          <% end %>
        <% end %>
      </div>
      <div class="user_post_info mb-1">
        投稿<%= @pictureposts.count %>件  フォロワー<%= @user.followers.count %>人  <%= @user.following.count %>人をフォロー
      </div>
      <div class="user_profile_info">
        <p><%= @user.name %></p>
        <p><%= @user.self_introduction %></p>
      </div>
    </div>
  </div>

  <%= render 'layouts/flash_messages' %>
    
  <div class="container-fluid">
    <div class="row grid">
      <% @pictureposts.each do |picturepost| %>
        <div class="col-4 img-box">
          <%= link_to picturepost_path(picturepost) do%>
            <%= image_tag picturepost.picture.url if picturepost.picture? %>
          <% end %>
        </div>
      <% end %>     
    </div>
  </div>

</div>

